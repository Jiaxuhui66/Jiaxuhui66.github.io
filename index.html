<!DOCTYPE html>
<html>
<head>
  <title>登录/注册</title>
</head>
<body>
  <div id="container">
    <div id="loginPage">
      <h1>登录</h1>
      <form id="loginForm">
        <label for="loginUsername">用户名:</label>
        <input type="text" id="loginUsername" name="loginUsername"><br><br>
        <label for="loginPassword">密码:</label>
        <input type="password" id="loginPassword" name="loginPassword"><br><br>
        <input type="submit" value="登录">
        <p><a href="#" id="goToRegister">没有账号？去注册</a></p>
      </form>
    </div>

    <div id="registerPage" style="display: none;">
      <h1>注册</h1>
      <form id="registerForm">
        <label for="registerUsername">用户名:</label>
        <input type="text" id="registerUsername" name="registerUsername"><br><br>
        <label for="registerPassword">密码:</label>
        <input type="password" id="registerPassword" name="registerPassword"><br><br>
        <input type="submit" value="注册">
        <p><a href="#" id="goToLogin">已有账号？去登录</a></p>
      </form>
    </div>
  </div>

<!--   <h1>用户列表</h1>
  <ul id="userList"></ul> -->

  <script>
    var container = document.getElementById("container");
    var loginPage = document.getElementById("loginPage");
    var registerPage = document.getElementById("registerPage");
    var goToRegister = document.getElementById("goToRegister");
    var goToLogin = document.getElementById("goToLogin");

    // 隐藏注册页面，显示登录页面
    goToLogin.addEventListener("click", function(event) {
      event.preventDefault();
      registerPage.style.display = "none";
      loginPage.style.display = "block";
    });

    // 隐藏登录页面，显示注册页面
    goToRegister.addEventListener("click", function(event) {
      event.preventDefault();
      loginPage.style.display = "none";
      registerPage.style.display = "block";
    });

    // 注册表单提交处理函数
    document.getElementById("registerForm").addEventListener("submit", function(event) {
      event.preventDefault(); // 阻止表单的默认提交行为

      // 获取表单字段的值
      var username = document.getElementById("registerUsername").value;
      var password = document.getElementById("registerPassword").value;

      // 获取已存在的用户列表
      var userList = [];
      var storedUserList = localStorage.getItem("userList");
      if (storedUserList) {
        userList = JSON.parse(storedUserList);
      }

      // 检查用户是否已存在
      var existingUser = userList.find(function(user) {
        return user.username === username;
      });

      if (existingUser) {
        alert('用户名已存在');
      } else {
        // 将新用户添加到列表中
        userList.push({ username: username, password: password });

        // 保存更新后的用户列表到localStorage
        localStorage.setItem("userList", JSON.stringify(userList));

        alert('注册成功');
      }

      refreshUserList(); // 刷新用户列表
    });

    // 登录表单提交处理函数
    
   document.getElementById("loginForm").addEventListener("submit", function(event) {
  event.preventDefault();

  // 获取表单字段的值
  var username = document.getElementById("loginUsername").value;
  var password = document.getElementById("loginPassword").value;

  // 获取已存在的用户列表
  var userList = [];
  var storedUserList = localStorage.getItem("userList");
  if (storedUserList) {
    userList = JSON.parse(storedUserList);
  }

  // 检查登录信息是否正确
  var loggedInUser = userList.find(function(user) {
    return user.username === username && user.password === password;
  });

  if (loggedInUser) {
    alert('登录成功');
    window.location.href = "home.html"; // 页面重定向到home.html
  } else {
    alert('用户名或密码错误');
  }
});

     // 删除用户
     function deleteUser(username) {
      // 获取已存在的用户列表
      var userList = [];
      var storedUserList = localStorage.getItem("userList");
      if (storedUserList) {
        userList = JSON.parse(storedUserList);
      }

      // 在列表中查找并删除指定用户名的用户
      var index = -1;
      for (var i = 0; i < userList.length; i++) {
        if (userList[i].username === username) {
          index = i;
          break;
        }
      }
      if (index > -1) {
        userList.splice(index, 1);
      }

      // 更新localStorage中的用户列表
      localStorage.setItem("userList", JSON.stringify(userList));

      refreshUserList(); // 刷新用户列表
    }

    // 获取用户列表
    function refreshUserList() {
      // 获取已存在的用户列表
      var userList = [];
      var storedUserList = localStorage.getItem("userList");
      if (storedUserList) {
        userList = JSON.parse(storedUserList);
      }

      // 清空用户列表
      var userListElement = document.getElementById("userList");
      userListElement.innerHTML = "";

      // 添加用户到列表中
      userList.forEach(function(user) {
        var li = document.createElement("li");
        li.textContent = user.username + " - " + user.password;
        userListElement.appendChild(li);

        var deleteButton = document.createElement("button");
        deleteButton.textContent = "删除";
        deleteButton.addEventListener("click", function() {
          deleteUser(user.username);
        });
        li.appendChild(deleteButton);
      });
      // 页面加载时刷新用户列表
document.addEventListener("DOMContentLoaded", function() {
  refreshUserList();
});
    }
  </script>
</body>
</html>
